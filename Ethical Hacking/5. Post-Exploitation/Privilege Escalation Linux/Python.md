
There a three different ways to escalate privileges in python:
- Wrong write permissions
- Library path
- `PYTHONPATH` environment variable

## Wrong write permissions

The following components may have wrong write permissions:
- actual script
- library used by the run script (happens in dev environment more frequently)

## Library path

We can check the python import path order list with `sys` or the variable `PYTHONPATH` and highjack a place higher in the list than the actual place where the library is used:

```console
python -c "import sys; print(sys.path)"
/usr/lib/python38.zip
/usr/lib/python3.8
/usr/lib/python3.8/lib-dynload
/usr/local/lib/python3.8/dist-packages
/usr/lib/python3/dist-packages
```

If a module would be loaded from `usr/lib/python3/dist-packages`, we could create the same module in `/usr/lib/python3`

Check the location of a package with `pip show <package-name>`

## PYTHONPATH

As mentioned previously, the `PYTHONPATH` determined the order of the locations python will look for packages.

```console
htb-student@lpenix:~$ sudo -l 

Matching Defaults entries for htb-student on ACADEMY-LPENIX:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User htb-student may run the following commands on ACADEMY-LPENIX:
    (ALL : ALL) SETENV: NOPASSWD: /usr/bin/python3
```

Here we have `SETENV`, meaning we can set environment variables when running a command (on same line). By just doing `sudo PYTHONPATH=~/<mypath> /usr/bin/python3 <my-script>`, we can load scripts from the desired location. 